define(["jquery","moment","ect","bootstrap"],function(t,e,n){function o(t){h=t}function s(){var e=t(".inputName").val();e.length<=2?alert("Ник должен быть длинее 2-х символов!"):h.auth(e)}function i(){if(t(this).is(".active"))return!1;var e=t(".list-rooms>.active");0!=e.length&&h.room_disconnect(e.text()),t(".list-rooms>div").removeClass("active"),t(this).addClass("active"),h.room_set(t(this).text(),t(this).data("id"))}function a(e){var n=[];e.forEach(function(e){n.push(t(v.render("list-item.ect",{text:e})))}),t(".list-users").html(n)}function r(e){var n=[];for(var o in e)n.push(t(v.render("list-item.ect",{text:o,id:e[o]})).click(i));t(".list-rooms").html(n)}function c(e){t(".connect_modal .modal-body").text("Сервер не отвечат, попытка подключиться #"+e),m(".connect_modal"),m(".auth_modal",!0)}function d(e,n){t(e).keypress(function(t){13==t.which&&n(e)}),t(e).find("button").click(function(){n(e)})}function m(e,n){n?t(e).modal("hide"):t(e).modal({backdrop:"static",keyboard:!1})}function u(t){var n=e(parseInt(t));return 0==e().diff(n,"days")?n.format("HH:mm:ss"):n.format("DD.MM.YY")}function l(e,n,o,s){if(!e||!n)return!1;if("Вы"==e||e==window.nick){e="Вы";var i='<span class="del_message">'+u(o)+"</span>"}else var i=u(o);t(".list-messages").prepend(v.render("message.ect",{name:e,text:n,date:i,id:s}))}function f(t,e,n){n.send(JSON.stringify({type:t,data:e}))}var h,v=n({root:"/templates"});return{add_mess:l,get_date:u,modal:m,form_on:d,disconnect:c,update_room:r,update_users:a,room_select:i,auth_check:s,set_socket:o,send_socket:f}});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImZ1bmN0aW9ucy5qcyJdLCJuYW1lcyI6WyJkZWZpbmUiLCIkIiwibW9tZW50IiwiRUNUIiwic2V0X3NvY2tldCIsInMiLCJzb2NrZXQiLCJhdXRoX2NoZWNrIiwibmljayIsInZhbCIsImxlbmd0aCIsImFsZXJ0IiwiYXV0aCIsInJvb21fc2VsZWN0IiwidGhpcyIsImlzIiwib2xkX3Jvb20iLCJyb29tX2Rpc2Nvbm5lY3QiLCJ0ZXh0IiwicmVtb3ZlQ2xhc3MiLCJhZGRDbGFzcyIsInJvb21fc2V0IiwiZGF0YSIsInVwZGF0ZV91c2VycyIsImxpc3QiLCJ1c2VycyIsImZvckVhY2giLCJuYW1lIiwicHVzaCIsInJlbmRlcmVyIiwicmVuZGVyIiwiaHRtbCIsInVwZGF0ZV9yb29tIiwicm9vbXMiLCJpZCIsImNsaWNrIiwiZGlzY29ubmVjdCIsIm4iLCJtb2RhbCIsImZvcm1fb24iLCJlbCIsImNhbGxiYWNrIiwia2V5cHJlc3MiLCJlIiwid2hpY2giLCJmaW5kIiwiaGlkZSIsImJhY2tkcm9wIiwia2V5Ym9hcmQiLCJnZXRfZGF0ZSIsInRpbWVfaW50IiwidGltZSIsInBhcnNlSW50IiwiZGlmZiIsImZvcm1hdCIsImFkZF9tZXNzIiwid2luZG93IiwiZGF0ZSIsInByZXBlbmQiLCJzZW5kX3NvY2tldCIsInR5cGUiLCJzZW5kIiwiSlNPTiIsInN0cmluZ2lmeSIsInJvb3QiXSwibWFwcGluZ3MiOiJBQUFBQSxRQUFRLFNBQVUsU0FBVSxNQUFPLGFBQWMsU0FBU0MsRUFBRUMsRUFBUUMsR0FHaEUsUUFBU0MsR0FBV0MsR0FDaEJDLEVBQVNELEVBUWIsUUFBU0UsS0FDTCxHQUFJQyxHQUFPUCxFQUFFLGNBQWNRLEtBQ3ZCRCxHQUFLRSxRQUFVLEVBQUdDLE1BQU0sd0NBQ3ZCTCxFQUFPTSxLQUFLSixHQUlyQixRQUFTSyxLQUNMLEdBQUdaLEVBQUVhLE1BQU1DLEdBQUcsV0FBWSxPQUFPLENBQ2pDLElBQUlDLEdBQVdmLEVBQUUsc0JBQ0ssSUFBbkJlLEVBQVNOLFFBQWFKLEVBQU9XLGdCQUFnQkQsRUFBU0UsUUFDekRqQixFQUFFLG1CQUFtQmtCLFlBQVksVUFDakNsQixFQUFFYSxNQUFNTSxTQUFTLFVBQ2pCZCxFQUFPZSxTQUFTcEIsRUFBRWEsTUFBTUksT0FBUWpCLEVBQUVhLE1BQU1RLEtBQUssT0FLakQsUUFBU0MsR0FBYUMsR0FDbEIsR0FBSUMsS0FDSkQsR0FBS0UsUUFBUSxTQUFVQyxHQUNuQkYsRUFBTUcsS0FBSzNCLEVBQUU0QixFQUFTQyxPQUFPLGlCQUN6QlosS0FBTVMsUUFHZDFCLEVBQUUsZUFBZThCLEtBQUtOLEdBSTFCLFFBQVNPLEdBQVlSLEdBQ2pCLEdBQUlTLEtBQ0osS0FBSSxHQUFJTixLQUFRSCxHQUNaUyxFQUFNTCxLQUFLM0IsRUFBRTRCLEVBQVNDLE9BQU8saUJBQ3pCWixLQUFNUyxFQUNOTyxHQUFJVixFQUFLRyxNQUNUUSxNQUFNdEIsR0FFZFosR0FBRSxlQUFlOEIsS0FBS0UsR0FJMUIsUUFBU0csR0FBV0MsR0FDaEJwQyxFQUFFLDhCQUE4QmlCLEtBQUssNENBQThDbUIsR0FDbkZDLEVBQU0sa0JBQ05BLEVBQU0sZUFBZSxHQUt6QixRQUFTQyxHQUFRQyxFQUFJQyxHQUNqQnhDLEVBQUV1QyxHQUFJRSxTQUFTLFNBQVVDLEdBQ04sSUFBWEEsRUFBRUMsT0FBYUgsRUFBU0QsS0FFaEN2QyxFQUFFdUMsR0FBSUssS0FBSyxVQUFVVixNQUFNLFdBQ3ZCTSxFQUFTRCxLQUtqQixRQUFTRixHQUFNSixFQUFJWSxHQUNYQSxFQUFNN0MsRUFBRWlDLEdBQUlJLE1BQU0sUUFDakJyQyxFQUFFaUMsR0FBSUksT0FBT1MsU0FBVSxTQUFVQyxVQUFVLElBSXBELFFBQVNDLEdBQVNDLEdBQ2QsR0FBSUMsR0FBT2pELEVBQU9rRCxTQUFTRixHQUMzQixPQUFtQyxJQUEvQmhELElBQVNtRCxLQUFLRixFQUFNLFFBQXFCQSxFQUFLRyxPQUFPLFlBQzdDSCxFQUFLRyxPQUFPLFlBSTVCLFFBQVNDLEdBQVM1QixFQUFNVCxFQUFNaUMsRUFBTWpCLEdBQ2hDLElBQUtQLElBQVNULEVBQU0sT0FBTyxDQUMzQixJQUFXLE1BQVJTLEdBQWdCQSxHQUFRNkIsT0FBT2hELEtBQU0sQ0FDcENtQixFQUFPLElBQ1AsSUFBSThCLEdBQU8sNkJBQTZCUixFQUFTRSxHQUFNLGNBRXRELElBQUlNLEdBQU9SLEVBQVNFLEVBQ3pCbEQsR0FBRSxrQkFBa0J5RCxRQUFRN0IsRUFBU0MsT0FBTyxlQUN4Q0gsS0FBTUEsRUFDTlQsS0FBTUEsRUFDTnVDLEtBQU1BLEVBQ052QixHQUFJQSxLQUlaLFFBQVN5QixHQUFZQyxFQUFLdEMsRUFBS2hCLEdBQzNCQSxFQUFPdUQsS0FBS0MsS0FBS0MsV0FBV0gsS0FBTUEsRUFBTXRDLEtBQU1BLEtBbkdsRCxHQUNJaEIsR0FEQXVCLEVBQVcxQixHQUFNNkQsS0FBTyxjQXFHNUIsUUFDSVQsU0FBVUEsRUFDVk4sU0FBVUEsRUFDVlgsTUFBT0EsRUFDUEMsUUFBU0EsRUFDVEgsV0FBWUEsRUFDWkosWUFBYUEsRUFDYlQsYUFBY0EsRUFDZFYsWUFBYUEsRUFDYk4sV0FBWUEsRUFDWkgsV0FBWUEsRUFDWnVELFlBQWFBIiwiZmlsZSI6ImZ1bmN0aW9ucy5qcyIsInNvdXJjZXNDb250ZW50IjpbImRlZmluZShbJ2pxdWVyeScsICdtb21lbnQnLCAnZWN0JywgJ2Jvb3RzdHJhcCddLCBmdW5jdGlvbigkLG1vbWVudCwgRUNUKSB7XG4gICAgdmFyIHJlbmRlcmVyID0gRUNUKHsgcm9vdCA6ICcvdGVtcGxhdGVzJyB9KTtcbiAgICB2YXIgc29ja2V0O1xuICAgIGZ1bmN0aW9uIHNldF9zb2NrZXQocykge1xuICAgICAgICBzb2NrZXQgPSBzO1xuICAgIH1cbiAgICAvKlxuICAgICDQktGB0LUg0YTRg9C90LrRhtC40LhcbiAgICAgKi9cblxuICAgIC8qINCk0YPQvdC60YbQuNC4INC+0LHRgNCw0LHQvtGC0YfQuNC60L7QsiAqL1xuLy/Qn9GA0L7QstC10YDQutCwINC90LjQutCwXG4gICAgZnVuY3Rpb24gYXV0aF9jaGVjaygpIHtcbiAgICAgICAgdmFyIG5pY2sgPSAkKCcuaW5wdXROYW1lJykudmFsKCk7XG4gICAgICAgIGlmIChuaWNrLmxlbmd0aCA8PSAyKSBhbGVydCgn0J3QuNC6INC00L7Qu9C20LXQvSDQsdGL0YLRjCDQtNC70LjQvdC10LUgMi3RhSDRgdC40LzQstC+0LvQvtCyIScpO1xuICAgICAgICBlbHNlIHNvY2tldC5hdXRoKG5pY2spO1xuICAgIH1cblxuLy/QktGL0LHQvtGAINC60L7QvNC90LDRgtGLXG4gICAgZnVuY3Rpb24gcm9vbV9zZWxlY3QoKSB7XG4gICAgICAgIGlmKCQodGhpcykuaXMoJy5hY3RpdmUnKSkgcmV0dXJuIGZhbHNlO1xuICAgICAgICB2YXIgb2xkX3Jvb20gPSAkKCcubGlzdC1yb29tcz4uYWN0aXZlJyk7XG4gICAgICAgIGlmKG9sZF9yb29tLmxlbmd0aCAhPSAwKSBzb2NrZXQucm9vbV9kaXNjb25uZWN0KG9sZF9yb29tLnRleHQoKSk7XG4gICAgICAgICQoJy5saXN0LXJvb21zPmRpdicpLnJlbW92ZUNsYXNzKCdhY3RpdmUnKTtcbiAgICAgICAgJCh0aGlzKS5hZGRDbGFzcygnYWN0aXZlJylcbiAgICAgICAgc29ja2V0LnJvb21fc2V0KCQodGhpcykudGV4dCgpLCAkKHRoaXMpLmRhdGEoJ2lkJykpO1xuICAgIH1cblxuICAgIC8qINCk0YPQvdC60YbQuNC4INGB0LXRgNCy0LXRgNCwICovXG4vL9Cf0LDRgNGB0LjQvdCzINGB0L/QuNGB0LrQsCDQv9C+0LvRjNC30L7QstCw0YLQtdC70LXQuVxuICAgIGZ1bmN0aW9uIHVwZGF0ZV91c2VycyhsaXN0KSB7XG4gICAgICAgIHZhciB1c2VycyA9IFtdO1xuICAgICAgICBsaXN0LmZvckVhY2goZnVuY3Rpb24gKG5hbWUpIHtcbiAgICAgICAgICAgIHVzZXJzLnB1c2goJChyZW5kZXJlci5yZW5kZXIoJ2xpc3QtaXRlbS5lY3QnLCB7XG4gICAgICAgICAgICAgICAgdGV4dDogbmFtZVxuICAgICAgICAgICAgfSkpKTtcbiAgICAgICAgfSk7XG4gICAgICAgICQoJy5saXN0LXVzZXJzJykuaHRtbCh1c2Vycyk7XG4gICAgfVxuXG4vL9Cf0LDRgNGB0LjQvdCzINGB0L/QuNGB0LrQsCDQutC+0LzQvdCw0YJcbiAgICBmdW5jdGlvbiB1cGRhdGVfcm9vbShsaXN0KSB7XG4gICAgICAgIHZhciByb29tcyA9IFtdO1xuICAgICAgICBmb3IodmFyIG5hbWUgaW4gbGlzdCkge1xuICAgICAgICAgICAgcm9vbXMucHVzaCgkKHJlbmRlcmVyLnJlbmRlcignbGlzdC1pdGVtLmVjdCcsIHtcbiAgICAgICAgICAgICAgICB0ZXh0OiBuYW1lLFxuICAgICAgICAgICAgICAgIGlkOiBsaXN0W25hbWVdXG4gICAgICAgICAgICB9KSkuY2xpY2socm9vbV9zZWxlY3QpKTtcbiAgICAgICAgfVxuICAgICAgICAkKCcubGlzdC1yb29tcycpLmh0bWwocm9vbXMpO1xuICAgIH1cblxuLy/QntGC0L7QsdGA0LDQttC10L3QuNC1INGB0L7QvtCx0YnQtdC90LjRjyDQviDQvdC10LTQvtGB0YLRg9C/0L3QvtGB0YLQuCDRgdC10YDQstC10YDQsFxuICAgIGZ1bmN0aW9uIGRpc2Nvbm5lY3Qobikge1xuICAgICAgICAkKCcuY29ubmVjdF9tb2RhbCAubW9kYWwtYm9keScpLnRleHQoJ9Ch0LXRgNCy0LXRgCDQvdC1INC+0YLQstC10YfQsNGCLCDQv9C+0L/Ri9GC0LrQsCDQv9C+0LTQutC70Y7Rh9C40YLRjNGB0Y8gIycgKyBuKTtcbiAgICAgICAgbW9kYWwoJy5jb25uZWN0X21vZGFsJyk7XG4gICAgICAgIG1vZGFsKCcuYXV0aF9tb2RhbCcsIHRydWUpO1xuICAgIH1cblxuICAgIC8qINCe0LHRidC40LUg0YTRg9C90LrRhtC40LggKi9cbi8v0KTRg9C90LrRhtC40Y8g0L7QsdGA0LDQsdC+0YLQutC4INC/0L7Qu9C10Lkg0LTQu9GPINCy0LLQvtC00LBcbiAgICBmdW5jdGlvbiBmb3JtX29uKGVsLCBjYWxsYmFjaykge1xuICAgICAgICAkKGVsKS5rZXlwcmVzcyhmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgaWYgKGUud2hpY2ggPT0gMTMpIGNhbGxiYWNrKGVsKTtcbiAgICAgICAgfSk7XG4gICAgICAgICQoZWwpLmZpbmQoJ2J1dHRvbicpLmNsaWNrKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGNhbGxiYWNrKGVsKTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4vL9Cj0L/RgNCw0LLQu9C10L3QuNC1INC80L7QtNCw0LvRjNC90YvQvNC4INC+0LrQvdCw0LzQuFxuICAgIGZ1bmN0aW9uIG1vZGFsKGlkLCBoaWRlKSB7XG4gICAgICAgIGlmIChoaWRlKSAkKGlkKS5tb2RhbCgnaGlkZScpO1xuICAgICAgICBlbHNlICQoaWQpLm1vZGFsKHtiYWNrZHJvcDogJ3N0YXRpYycsIGtleWJvYXJkOiBmYWxzZX0pO1xuICAgIH1cblxuLy/Qn9C+0LvRg9GH0LXQvdC40LUg0LTQsNGC0LAg0LIg0LLQuNC00LUg0YHRgtGA0L7QutC4XG4gICAgZnVuY3Rpb24gZ2V0X2RhdGUodGltZV9pbnQpIHtcbiAgICAgICAgdmFyIHRpbWUgPSBtb21lbnQocGFyc2VJbnQodGltZV9pbnQpKTtcbiAgICAgICAgaWYgKG1vbWVudCgpLmRpZmYodGltZSwgJ2RheXMnKSA9PSAwKSByZXR1cm4gdGltZS5mb3JtYXQoJ0hIOm1tOnNzJyk7XG4gICAgICAgIGVsc2UgcmV0dXJuIHRpbWUuZm9ybWF0KCdERC5NTS5ZWScpO1xuICAgIH1cblxuLy/QlNC+0LHQsNCy0LvQtdC90LjQtSDQvdC+0LLQvtCz0L4g0YHQvtC+0LHRidC10L3QuNGPXG4gICAgZnVuY3Rpb24gYWRkX21lc3MobmFtZSwgdGV4dCwgdGltZSwgaWQpIHtcbiAgICAgICAgaWYgKCFuYW1lIHx8ICF0ZXh0KSByZXR1cm4gZmFsc2U7XG4gICAgICAgIGlmKG5hbWUgPT0gJ9CS0YsnIHx8IG5hbWUgPT0gd2luZG93Lm5pY2spIHtcbiAgICAgICAgICAgIG5hbWUgPSAn0JLRiyc7XG4gICAgICAgICAgICB2YXIgZGF0ZSA9ICc8c3BhbiBjbGFzcz1cImRlbF9tZXNzYWdlXCI+JytnZXRfZGF0ZSh0aW1lKSsnPC9zcGFuPic7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB2YXIgZGF0ZSA9IGdldF9kYXRlKHRpbWUpO1xuICAgICAgICAkKCcubGlzdC1tZXNzYWdlcycpLnByZXBlbmQocmVuZGVyZXIucmVuZGVyKCdtZXNzYWdlLmVjdCcsIHtcbiAgICAgICAgICAgIG5hbWU6IG5hbWUsXG4gICAgICAgICAgICB0ZXh0OiB0ZXh0LFxuICAgICAgICAgICAgZGF0ZTogZGF0ZSxcbiAgICAgICAgICAgIGlkOiBpZFxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIC8v0J7RgtC/0YDQsNCy0LrQsCDQtNCw0L3QvdGL0YUg0L/QviBzb2NrZXRcbiAgICBmdW5jdGlvbiBzZW5kX3NvY2tldCh0eXBlLGRhdGEsc29ja2V0KSB7XG4gICAgICAgIHNvY2tldC5zZW5kKEpTT04uc3RyaW5naWZ5KHt0eXBlOiB0eXBlLCBkYXRhOiBkYXRhfSkpO1xuICAgIH1cbiAgICByZXR1cm4ge1xuICAgICAgICBhZGRfbWVzczogYWRkX21lc3MsXG4gICAgICAgIGdldF9kYXRlOiBnZXRfZGF0ZSxcbiAgICAgICAgbW9kYWw6IG1vZGFsLFxuICAgICAgICBmb3JtX29uOiBmb3JtX29uLFxuICAgICAgICBkaXNjb25uZWN0OiBkaXNjb25uZWN0LFxuICAgICAgICB1cGRhdGVfcm9vbTogdXBkYXRlX3Jvb20sXG4gICAgICAgIHVwZGF0ZV91c2VyczogdXBkYXRlX3VzZXJzLFxuICAgICAgICByb29tX3NlbGVjdDogcm9vbV9zZWxlY3QsXG4gICAgICAgIGF1dGhfY2hlY2s6IGF1dGhfY2hlY2ssXG4gICAgICAgIHNldF9zb2NrZXQ6IHNldF9zb2NrZXQsXG4gICAgICAgIHNlbmRfc29ja2V0OiBzZW5kX3NvY2tldFxuICAgIH07XG59KTsiXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=
